<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## State Management Layer

This module provides the core abstractions for managing chat sessions and messages.

---

### Message

>      Message (role:str, content:str, id:Optional[str]=None,
>               pending:bool=False, metadata:Dict[str,Any]=<factory>)

*Represents a single chat message.*


---

### ChatSession

>      ChatSession (session_id:str,
>                   initial_messages:Optional[List[__main__.Message]]=None)

*Manages a single chat conversation.*


---

### SessionManager

>      SessionManager ()

*Abstract base class for managing multiple chat sessions.*


---

### InMemorySessionManager

>      InMemorySessionManager ()

*In-memory implementation of SessionManager.*


## Test the State Management Layer

::: {#72120a4c .cell execution_count=7}
``` {.python .cell-code}
# Test Message
msg = Message(role="User", content="Hello!", metadata={"timestamp": "2024-01-01"})
print(f"Message ID: {msg.id}")
print(f"Message Dict: {msg.to_dict()}")
```

::: {.cell-output .cell-output-stdout}
```
Message ID: b4f0106a-73cf-4c72-ba41-fb4abe9cc5b9
Message Dict: {'role': 'User', 'content': 'Hello!', 'id': 'b4f0106a-73cf-4c72-ba41-fb4abe9cc5b9', 'timestamp': '2024-01-01'}
```
:::
:::


::: {#f3d073dc .cell execution_count=8}
``` {.python .cell-code}
# Test ChatSession
session = ChatSession("test-123")
msg1 = session.add_message("User", "Hello")
msg2 = session.add_message("Assistant", "Hi there!", metadata={"model": "gpt-4"})
print(f"Session has {len(session)} messages")
print(f"Messages: {session.get_message_dicts()}")
```

::: {.cell-output .cell-output-stdout}
```
Session has 2 messages
Messages: [{'role': 'User', 'content': 'Hello', 'id': '28145e84-1fe0-44f3-9895-910f6bb4cb21'}, {'role': 'Assistant', 'content': 'Hi there!', 'id': '49ec40bc-fee9-4c61-924c-e426b0f5bca0', 'metadata': {'model': 'gpt-4'}}]
```
:::
:::


::: {#9bf3c288 .cell}
``` {.python .cell-code}
# Test SessionManager
manager = InMemorySessionManager()
s1 = manager.create_session("session-1")
s1.add_message("User", "First message")
print(f"Active sessions: {manager.list_sessions()}")
print(
    f"Retrieved session messages: {manager.get_session('session-1').get_message_dicts()}"
)
```

::: {.cell-output .cell-output-stdout}
```
Active sessions: ['session-1']
Retrieved session messages: [{'role': 'User', 'content': 'First message', 'id': 'e792fd98-a58b-4f6d-a47b-44f0c7a0bdb1'}]
```
:::
:::



